import streamlit as st
import pandas as pd

def run_excel_app():
    st.markdown("<h3 style='color:#D4AF37;'>ğŸ“Š Ù…Ø­Ù„Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø°ÙƒÙŠ (Excel)</h3>", unsafe_allow_html=True)
    
    # Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù
    uploaded_file = st.file_uploader("Ø§Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³Ù„ Ù‡Ù†Ø§ ÙŠØ§ Ø¨Ø·Ù„", type=['xlsx', 'csv'], key="excel_tool_uploader")
    
    if uploaded_file:
        try:
            # Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù
            if uploaded_file.name.endswith('.csv'):
                df = pd.read_csv(uploaded_file)
            else:
                df = pd.read_excel(uploaded_file)
            
            st.success("ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­! âœ…")
            
            # Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø¬Ø¯ÙˆÙ„
            st.write("---")
            st.markdown("#### ğŸ“‹ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª")
            st.dataframe(df)
            
        except Exception as e:
            st.error(f"Ø­ØµÙ„Øª Ù…Ø´ÙƒÙ„Ø© ÙˆØ£Ù†Ø§ Ø¨Ù‚Ø±Ø£ Ø§Ù„Ù…Ù„Ù: {e}")
